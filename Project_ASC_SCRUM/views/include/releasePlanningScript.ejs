<script>

	//SOCKET Open
	var socket = io.connect();
	
	<!-- /#page-wrapper -->
	//유저스토리 디테일 
	function detailStoryLi() {
		$('.DetailPoker').on('click', function(e){
			var push = $(this).attr('value');
			socket.emit('StoryDetail', {
				user_story_no : push
			});
		});
	};
	/** 마스터용 스토리 뿌리기 */
	function detailStoryLiMaster() {
		$('.DetailPokerMaster').on('click', function(e){
			var push = $(this).attr('value');
			//UserStory 호출
			socket.emit('StoryDetail', {
				user_story_no : push
			});
			//Poker 정보 호출
			socket.emit('PokerDetail', {
				user_story_no : push
			});
			//join_list 정보 호출
			socket.emit('Join_List', {
				project_join_no : <%=project_join_no%>,
				user_story_no : push
			});
		});
	};
			
	//유저스토리 불러서 넣기
	var cateNo;
	socket.on('StoryDetail', function (data){
		var da = data.data[0];
		var textfield = $('.PokerStoryContent');
		$('.PokerStory').val(da.user_story_no);
		var text = '';
		text += 'UserStory 제목    : '+da.title + "\n";
		text += 'UserStory 사용자 : '+da.as_a + "\n";
		text += 'UserStory 기능    : '+da.i_want + "\n";
		text += 'UserStory 목적    : '+da.so_that + "\n";
		textfield.html(text);
	});
	//포커 정보 부르기
	socket.on('PokerDetail', function (data){
		var da = data.data[0];
	});
	//포커 관련 모든 인원수 및 점수 부르기
	socket.on('Join_List', function (data){
		var count = data.count[0].count;
		var vote = data.vote[0].Vote;
		var score = data.score;
		var List ='';
		var point0 = 0;
		var point1 = 0;
		var point2 = 0;
		var point5 = 0;
		var point10 = 0;
		var etc = 0;
		count = --count;
		
		List += vote;
		List += ' / ' + (count);
		
		$('.Poker_Join_List').val('');
		$('.Poker_Join_List').val(List);
		
		var ScoreAdd  = 0;		
		if(score.length > 0){
			for(var i = 0; i < score.length; i++){
				if(score[i].score == 0.5){
					point0++;				
				} else if(score[i].score == 1){
					point1++;				
				} else if(score[i].score == 2){
					point2++;				
				} else if(score[i].score == 5){
					point5++;				
				} else if(score[i].score == 10){
					point10++;				
				} else {
					etc++;				
				}
				if(score[i].score > 0){
					ScoreAdd += score[i].score;
				}
			};
		};
		if(ScoreAdd > 0){
			ScoreAdd = (ScoreAdd / count);
			ScoreAdd += (ScoreAdd % count);
		}
		
		$('.point0').val('');
		$('.point1').val('');
		$('.point2').val('');
		$('.point5').val('');
		$('.point10').val('');
		$('.ScoreAdd').val('');
		$('.point0').val(point0);
		$('.point1').val(point1);
		$('.point2').val(point2);
		$('.point5').val(point5);
		$('.point10').val(point10);
		$('.ScoreAdd').val(ScoreAdd);
		
	});
	detailStoryLi();
	detailStoryLiMaster();
</script>